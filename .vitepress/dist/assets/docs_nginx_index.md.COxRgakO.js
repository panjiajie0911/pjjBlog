import{_ as i,c as a,o as n,ah as l,ai as p}from"./chunks/framework.BjT6hq4z.js";const c=JSON.parse('{"title":"关于 nginx","description":"","frontmatter":{},"headers":[],"relativePath":"docs/nginx/index.md","filePath":"docs/nginx/index.md"}'),t={name:"docs/nginx/index.md"};function h(e,s,k,r,g,d){return n(),a("div",null,[...s[0]||(s[0]=[l('<h1 id="关于-nginx" tabindex="-1">关于 nginx <a class="header-anchor" href="#关于-nginx" aria-label="Permalink to “关于 nginx”">​</a></h1><h2 id="正向代理和反向代理" tabindex="-1">正向代理和反向代理 <a class="header-anchor" href="#正向代理和反向代理" aria-label="Permalink to “正向代理和反向代理”">​</a></h2><table tabindex="0"><thead><tr><th>正向代理</th><th>反向代理</th></tr></thead><tbody><tr><td>客户端能感知，知道代理存在</td><td>客户端不能感知，不知道代理存在</td></tr><tr><td>隐藏真实客户端</td><td>隐藏真实服务端</td></tr></tbody></table><p>正向代理：客户端不直接访问服务器， 通过代理服务器访，服务器不知道客户端的 IP,只知道代理服务器的 IP。此时，客户端和代理服务器是“一体”。</p><p>反向代理：客户端直接访问代理服务器，不直接访问服务器，由代理服务器去分发请求。此时，代理服务器和服务器是“一体”。</p><p><img src="'+p+`" alt="alt text"></p><p>nginx 就是反向代理的这个代理服务器。</p><h2 id="目录结构" tabindex="-1">目录结构 <a class="header-anchor" href="#目录结构" aria-label="Permalink to “目录结构”">​</a></h2><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──client_body_temp</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 #POST 大文件暂存目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──conf</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                             #Nginx 所有配置文件的目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    ├──fastcgi.conf</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                 #fastcgi 相关参数的配置文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   ├── fastcgi.conf.default         # fastcgi.conf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 的原始备份文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   ├── fastcgi_params               # fastcgi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 的参数文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   ├── fastcgi_params.default      </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   ├── koi-utf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   ├── koi-win</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   ├── mime.types                   # </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 媒体类型</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   ├── mime.types.default</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   ├── nginx.conf                   #这是</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Nginx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 默认的主配置文件，日常使用和修改的文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   ├── nginx.conf.default</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   ├── scgi_params                 # scgi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 相关参数文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   ├── scgi_params.default  </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   ├── uwsgi_params                 # uwsgi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 相关参数文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   ├── uwsgi_params.default</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   └── win-utf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├── fastcgi_temp                     # fastcgi</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 临时数据目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├── html                             # Nginx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 默认站点目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   ├── 50x.html                     # </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 错误页面优雅替代显示文件，例如出现</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 502</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 错误时会调用此页面</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   └── index.html                   # </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 默认的首页文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├── logs                             # Nginx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 日志目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   ├── access.log                   # </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 访问日志文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   ├── error.log                   # </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 错误日志文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   └── nginx.pid                   # pid</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 文件，Nginx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 进程启动后，会把所有进程的</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ID</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 号写到此文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├── proxy_temp                       # </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 临时目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──sbin                             #Nginx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 可执行文件目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">│   └──nginx                       #Nginx</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 二进制可执行程序</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">├──scgi_temp                       #临时目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">└──uwsgi_temp                      #临时目录</span></span></code></pre></div><h2 id="核心文件-nginx-conf" tabindex="-1">核心文件 nginx.conf <a class="header-anchor" href="#核心文件-nginx-conf" aria-label="Permalink to “核心文件 nginx.conf”">​</a></h2><p>nginx 的核心功能在 conf 文件夹中的 <strong>nginx.conf</strong> 文件中。</p><p><strong>nginx.conf</strong> 本质上是一个一个的模块，一个{}用来表示一个模块，模块中再设置具体的指令。它的结构如下：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">全局模块</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #nginx的用户名，日志的存放路径</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">events模块</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #事件模块</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">http模块</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #配置和http相关的模块，比如超时连接时间，代理等等，内含server模块</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  server模块</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #配置虚拟主机，内含location模块</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    location模块</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> #配置url路由规则</span></span></code></pre></div><p>比如下面这样的基础配置</p><div class="language-vbscript"><button title="Copy Code" class="copy"></button><span class="lang">vbscript</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>全局模块</span></span>
<span class="line"><span>event 模块</span></span>
<span class="line"><span>http 模块</span></span>
<span class="line"><span>    server模块  // server模块可以是多个</span></span>
<span class="line"><span>        location块 //  location块可以是多个</span></span>
<span class="line"><span>        location块</span></span>
<span class="line"><span>        ....</span></span>
<span class="line"><span>    server模块</span></span>
<span class="line"><span>        location块</span></span>
<span class="line"><span>        location块</span></span>
<span class="line"><span>        ...</span></span>
<span class="line"><span>    ....</span></span></code></pre></div><p>基础的参数配置详解，请参见 <strong>nginx.conf</strong>文件。</p><h2 id="示例-用-nginx-搭建一个本地的网站" tabindex="-1">示例：用 nginx 搭建一个本地的网站 <a class="header-anchor" href="#示例-用-nginx-搭建一个本地的网站" aria-label="Permalink to “示例：用 nginx 搭建一个本地的网站”">​</a></h2><h2 id="反向代理的原理" tabindex="-1">反向代理的原理 <a class="header-anchor" href="#反向代理的原理" aria-label="Permalink to “反向代理的原理”">​</a></h2><p>通过「监听端口 → 解析请求 → 匹配规则 → 转发请求 → 回传响应」来实现的。</p>`,19)])])}const o=i(t,[["render",h]]);export{c as __pageData,o as default};
